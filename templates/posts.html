{% extends 'flatpages/default.html' %}

{% load custom_filters %}
{% load custom_tags %}

{% block title %}
Новости
{% endblock title %}

{% block content %}
    {% if request.user.is_authenticated and not is_not_author %}
    <div class="content-menu">
        <div class="content-menu-left"></div>
        <div class="content-menu-right">
            <ul>
                <li><a href="create/">Добавить новость</a></li>
            </ul>
        </div>
    </div>    
    {% endif %}

    {% for post in posts %}
        <div class="post">
            <div class="post-title">
                <div class="post-h1"><a href="{{ post.id }}">{{ post.title|censor }}</a></div>
            </div>
            <div class="main">
                <div class="post-image">
                    <img src="{{MEDIA_DIR}}{{post.image.url}}">
                </div>
                <div class="post-text">
                    <div class="post-h3-main">{{ post.date_in|date:'d M Y' }}</div>
                    <div class="post-h2-main">{{ post.text|truncatechars:200}}</div>
                    <div class="post-h3-right">Автор: {{ post.author.user }}</div>
                </div>
            </div>
        </div>
        <hr class="hr-shelf">
    {% endfor %}
    
    <div class="pagination">
        {% if page_obj.has_previous %}
            <a href="?{% url_replace page=1 %}"><<</a>
            {% if page_obj.previous_page_number != 1 %}
                <a href="?{% url_replace page=page_obj.previous_page_number %}">{{ page_obj.previous_page_number }}</a>
            {% endif %}
        {% endif %}

        <span>{{ page_obj.number }}</span>

        {% if page_obj.has_next %}
            <a href="?{% url_replace page=page_obj.next_page_number %}">{{ page_obj.next_page_number }}</a>
            {% if paginator.num_pages != page_obj.next_page_number %}
                <a href="?{% url_replace page=page_obj.paginator.num_pages %}">>></a>
            {% endif %}
        {% endif %}
    </div>

{% endblock content %}

{% block rightsidebar %}
    <div class="right-sidebar-filter">
        <form class="form-filter" action="" method="get">
            {{ filterset.form.as_p }}
            <input type="submit" value="Применить" />
        </form>
    </div>
{% endblock rightsidebar %}